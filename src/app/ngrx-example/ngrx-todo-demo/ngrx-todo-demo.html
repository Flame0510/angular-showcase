<div class="todo-container">
  <div class="todo-main">
    <h2>Todo List Example</h2>

    <div class="todo-input-section">
      <input
        type="text"
        class="todo-input"
        placeholder="Cosa devi fare?"
        [ngModel]="newTodoText()"
        (ngModelChange)="onNewTodoTextChange.emit($event)"
        (keyup.enter)="onAddTodo.emit()"
      />
      <button class="btn btn-add" (click)="onAddTodo.emit()">
        <span class="btn-icon">‚ûï</span> Aggiungi
      </button>
    </div>

    <div class="todo-filters">
      <button
        class="filter-btn"
        [class.active]="todoState().filter === 'all'"
        (click)="onSetFilter.emit('all')"
      >
        Tutti ({{ todoState().todos.length }})
      </button>
      <button
        class="filter-btn"
        [class.active]="todoState().filter === 'active'"
        (click)="onSetFilter.emit('active')"
      >
        Attivi ({{ activeTodosCount() }})
      </button>
      <button
        class="filter-btn"
        [class.active]="todoState().filter === 'completed'"
        (click)="onSetFilter.emit('completed')"
      >
        Completati ({{ completedTodosCount() }})
      </button>
    </div>

    <div class="todo-list">
      @for (todo of filteredTodos(); track todo.id) {
      <div class="todo-item" [class.completed]="todo.completed">
        <input
          type="checkbox"
          class="todo-checkbox"
          [checked]="todo.completed"
          (change)="onToggleTodo.emit(todo.id)"
        />
        <span class="todo-text">{{ todo.text }}</span>
        <button class="btn-delete" (click)="onDeleteTodo.emit(todo.id)">
          üóëÔ∏è
        </button>
      </div>
      } @empty {
      <div class="todo-empty">
        @if (todoState().filter === 'all') { Nessun todo ancora. Aggiungine
        uno! } @else if (todoState().filter === 'active') { Nessun todo
        attivo! üéâ } @else { Nessun todo completato ancora. }
      </div>
      }
    </div>

    @if (completedTodosCount() > 0) {
    <div class="todo-footer">
      <button class="btn btn-clear-completed" (click)="onClearCompleted.emit()">
        Elimina completati
      </button>
    </div>
    }
  </div>

  <div class="todo-sidebar">
    <div class="actions-log">
      <div class="log-header">
        <h3>‚ö° Actions Log</h3>
        <button class="btn-clear" (click)="onClearLogs.emit()">Clear</button>
      </div>
      <div class="log-list">
        @if (actionsLog().length === 0) {
        <div class="log-empty">Nessuna action ancora...</div>
        } @for (action of actionsLog(); track $index) {
        <div class="log-item">
          <span class="log-time">{{ $index + 1 }}</span>
          <span class="log-action">{{ action }}</span>
        </div>
        }
      </div>
    </div>

    <div class="state-preview">
      <h3>üè™ Current State</h3>
      <pre><code>{{ todoState() | json }}</code></pre>
    </div>
  </div>
</div>
